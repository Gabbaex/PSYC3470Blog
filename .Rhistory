review_by_rating <- review_data %>%
group_by(rating) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = review_by_rating, mapping = aes(x=rating, y=counts))+
geom_bar(stat = "identity", fill = "white", color = "black")+
xlab("")+ylab("")+
ggtitle(label = "Review ratings", subtitle = "Number of Reviews for each rating")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))
# FIX THIS LAST PART
#get number of reviews per rating
review_by_verified_counts <- review_data %>%
group_by(verified, rating) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = review_by_verified_counts, mapping = aes(x = rating, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity", position = "dodge")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
xlab("")+ylab("")+
ggtitle(label = "Review ratings", subtitle = "Number of Reviews for each rating")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))
#| label: tbl-verified descriptives
#| tbl-cap: Average ratings by purchase status
#get mean and median ratings by verified users
verified_descriptives <- review_data %>%
group_by(verified) %>%
summarize(`Mean rating` = round(mean(rating), digits = 2),
`Median rating` = median(rating))
#print table
knitr::kable(verified_descriptives)
year_rating_status <- review_data %>%
group_by(year, verified) %>%
summarise(mean_rating = mean(rating), .groups = 'drop')
ggplot(data = year_rating_status,
mapping = aes(x=year, y=mean_rating, color = verified))+
geom_point(aes())+
geom_line()+
scale_color_manual(values = c('#1b9e77','#d95f02'))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Average Ratings", subtitle = "By year and purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))
#d95s02 orange, #1b9e77 green
#| tbl-subcap: Table
#get number of verified users
verified_reviews <- review_data %>%
group_by(verified) %>%
summarize(counts = n())
#print table
knitr::kable(verified_reviews)
#get number of reviews per year
year_by_verified_counts <- review_data %>%
group_by(year,verified) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = year_by_verified_counts,
mapping = aes(x=year, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
barplot(data, col = 1:nrow(data), legend.text = TRUE, args.legend = list(x = "bottom"))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Number of Reviews per year", subtitle = "By purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))
#get number of reviews per year
year_by_verified_counts <- review_data %>%
group_by(year,verified) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = year_by_verified_counts,
mapping = aes(x=year, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
barplot(data, col = 1:nrow(data), legend.text = TRUE, args.legend = list(x = "bottom", inset = c(-0.15,0)))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Number of Reviews per year", subtitle = "By purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))
#get number of reviews per year
year_by_verified_counts <- review_data %>%
group_by(year,verified) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = year_by_verified_counts,
mapping = aes(x=year, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
barplot(data, col = 1:nrow(verified), legend.text = TRUE, args.legend = list(x = "bottom", inset = c(-0.15,0)))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Number of Reviews per year", subtitle = "By purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))
#get number of reviews per year
year_by_verified_counts <- review_data %>%
group_by(year,verified) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = year_by_verified_counts,
mapping = aes(x=year, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity", (data, col = 1:nrow(verified), legend.text = TRUE, args.legend = list(x = "bottom", inset = c(-0.15,0)))+)+
#get number of reviews per year
year_by_verified_counts <- review_data %>%
group_by(year,verified) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = year_by_verified_counts,
mapping = aes(x=year, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity", col = 1:nrow(verified), legend.text = TRUE, args.legend = list(x = "bottom", inset = c(-0.15,0)))+)+
#get number of reviews per year
year_by_verified_counts <- review_data %>%
group_by(year,verified) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = year_by_verified_counts,
mapping = aes(x=year, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Number of Reviews per year", subtitle = "By purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))
#get number of reviews per year
year_by_verified_counts <- review_data %>%
group_by(year,verified) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = year_by_verified_counts,
mapping = aes(x=year, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Number of Reviews per year", subtitle = "By purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))+
theme(legend.position = "bottom")
#get number of reviews per year
year_by_verified_counts <- review_data %>%
group_by(year,verified) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = year_by_verified_counts,
mapping = aes(x=year, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Number of Reviews per year", subtitle = "By purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))+
theme(legend.position = "bottom")
#get number of reviews per year
year_by_verified_counts <- review_data %>%
group_by(year,verified) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = year_by_verified_counts,
mapping = aes(x=year, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Number of Reviews per year", subtitle = "By purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))+
theme(legend.position = "bottom", legend.background = "lightgrey")
#get number of reviews per year
year_by_verified_counts <- review_data %>%
group_by(year,verified) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = year_by_verified_counts,
mapping = aes(x=year, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Number of Reviews per year", subtitle = "By purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))+
theme(legend.position = "bottom", legend.background(color = "lightgrey")
#get number of reviews per year
year_by_verified_counts <- review_data %>%
group_by(year,verified) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = year_by_verified_counts,
mapping = aes(x=year, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Number of Reviews per year", subtitle = "By purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))+
theme(legend.position = "bottom", legend.background = element_rect(fill = "lightgrey")
#get number of reviews per year
year_by_verified_counts <- review_data %>%
group_by(year,verified) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = year_by_verified_counts,
mapping = aes(x=year, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Number of Reviews per year", subtitle = "By purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))+
theme(legend.position = "bottom", legend.background = element_rect(fill = "lightgrey")
#get number of reviews per year
year_by_verified_counts <- review_data %>%
group_by(year,verified) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = year_by_verified_counts,
mapping = aes(x=year, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Number of Reviews per year", subtitle = "By purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"), legend.position = "bottom", legend.background = element_rect(fill = "lightgrey"))
#get number of reviews per rating
review_by_verified_counts <- review_data %>%
group_by(verified, rating) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = review_by_verified_counts, mapping = aes(x = rating, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity", position = "dodge")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
xlab("")+ylab("")+
ggtitle(label = "Review ratings", subtitle = "Number of Reviews for each rating")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"), legend.position = "bottom", legend.background = element_rect(fill = "lightgrey"))
#get number of reviews per rating
review_by_verified_counts <- review_data %>%
group_by(verified, rating) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = review_by_verified_counts, mapping = aes(x = rating, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity", position = "dodge", color = "black")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
xlab("")+ylab("")+
ggtitle(label = "Review ratings", subtitle = "Number of Reviews for each rating")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"), legend.position = "bottom", legend.background = element_rect(fill = "lightgrey"))
#get number of reviews per year
year_by_verified_counts <- review_data %>%
group_by(year,verified) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = year_by_verified_counts,
mapping = aes(x=year, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity", color = "black")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Number of Reviews per year", subtitle = "By purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"), legend.position = "bottom", legend.background = element_rect(fill = "lightgrey"))
#get number of reviews per rating
review_by_rating <- review_data %>%
group_by(rating) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = review_by_rating, mapping = aes(x=rating, y=counts))+
geom_bar(stat = "identity", fill = "white", color = "black")+
xlab("")+ylab("")+
ggtitle(label = "Review ratings", subtitle = "Number of Reviews for each rating")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))+
options(scipen = 999)
#get number of reviews per rating
review_by_rating <- review_data %>%
group_by(rating) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = review_by_rating, mapping = aes(x=rating, y=counts))+
geom_bar(stat = "identity", fill = "white", color = "black", options(scipen = 999))+
xlab("")+ylab("")+
ggtitle(label = "Review ratings", subtitle = "Number of Reviews for each rating")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))
#get number of reviews per rating
review_by_rating <- review_data %>%
group_by(rating) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = review_by_rating, mapping = aes(x=rating, y=counts))+
geom_bar(stat = "identity", fill = "white", color = "black")+
xlab("")+ylab("")+
ggtitle(label = "Review ratings", subtitle = "Number of Reviews for each rating")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))
# FIX THIS LAST PART
#get number of reviews per rating
review_by_rating <- review_data %>%
group_by(rating) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = review_by_rating, mapping = aes(x=rating, y=counts))+
geom_bar(stat = "identity", fill = "white", color = "black")+
xlab("")+ylab("")+
ggtitle(label = "Review ratings", subtitle = "Number of Reviews for each rating")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))
# FIX THIS LAST PART
year_rating_status <- review_data %>%
group_by(year, verified) %>%
summarise(mean_rating = mean(rating), .groups = 'drop')
ggplot(data = year_rating_status,
mapping = aes(x=year, y=mean_rating, color = verified))+
geom_point(aes())+
geom_line()+
scale_color_manual(values = c('#1b9e77','#d95f02'))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Average Ratings", subtitle = "By year and purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"), legend.position = "bottom", legend.background = element_rect(fill = "lightgrey"))
year_rating_status <- review_data %>%
group_by(year, verified) %>%
summarise(mean_rating = mean(rating), .groups = 'drop')
ggplot(data = year_rating_status,
mapping = aes(x=year, y=mean_rating, color = verified))+
geom_point(aes())+
geom_line()+
scale_color_manual(values = c('#1b9e77','#d95f02'))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Average Ratings", subtitle = "By year and purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"), legend.position = "bottom", legend.background = element_rect(fill = "lightgrey", color = "lightgrey"))
year_rating_status <- review_data %>%
group_by(year, verified) %>%
summarise(mean_rating = mean(rating), .groups = 'drop')
ggplot(data = year_rating_status,
mapping = aes(x=year, y=mean_rating, color = verified))+
geom_point(aes())+
geom_line()+
scale_color_manual(values = c('#1b9e77','#d95f02'))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Average Ratings", subtitle = "By year and purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"), legend.position = "bottom", legend.background = element_rect(fill = "lightgrey"))
#| tbl-subcap: Table 1. Number of reviews by purchase status
#get number of verified users
verified_reviews <- review_data %>%
group_by(verified) %>%
summarize(counts = n())
#print table
knitr::kable(verified_reviews)
#| tbl-subcap: Table 1. Number of reviews by purchase status
#get number of verified users
verified_reviews <- review_data %>%
group_by(verified) %>%
summarize(counts = n())
#print table
knitr::kable(verified_reviews)
#| tbl-subcap: Table 1. Number of reviews by purchase status
#get number of verified users
verified_reviews <- review_data %>%
group_by(verified) %>%
summarize(counts = n())
#print table
knitr::kable(verified_reviews)
#| tbl-subcap: Table 1. Number of reviews by purchase status
#get number of verified users
verified_reviews <- review_data %>%
group_by(verified) %>%
summarize(counts = n())
#print table
knitr::kable(verified_reviews)
#| tbl-subcap: Table 1. Number of reviews by purchase status
#get number of verified users
verified_reviews <- review_data %>%
group_by(verified) %>%
summarize(counts = n())
#print table
knitr::kable(verified_reviews)
#| tbl-subcap: Table 1. Number of reviews by purchase status
#get number of verified users
verified_reviews <- review_data %>%
group_by(verified) %>%
summarize(counts = n())
#print table
knitr::kable(verified_reviews)
?fig.subcap
??fig.subcap
#| tbl-subcap: Table 1. Number of reviews by purchase status
#get number of verified users
verified_reviews <- review_data %>%
group_by(verified) %>%
summarize(counts = n())
#print table
knitr::kable(verified_reviews)
#| tbl-subcap: Table 1. Number of reviews by purchase status
#get number of verified users
verified_reviews <- review_data %>%
group_by(verified) %>%
summarize(counts = n())
#print table
knitr::kable(verified_reviews)
#| tbl-subcap: Table 1. Number of reviews by purchase status
#get number of verified users
verified_reviews <- review_data %>%
group_by(verified) %>%
summarize(counts = n())
#print table
knitr::kable(verified_reviews)
#| tbl-subcap: Table 1. Number of reviews by purchase status
#get number of verified users
verified_reviews <- review_data %>%
group_by(verified) %>%
summarize(counts = n())
#print table
knitr::kable(verified_reviews)
#| tbl-subcap: Table 1. Number of reviews by purchase status
#get number of verified users
verified_reviews <- review_data %>%
group_by(verified) %>%
summarize(counts = n())
#print table
knitr::kable(verified_reviews)
#| tbl-subcap: Table 1. Number of reviews by purchase status
#get number of verified users
verified_reviews <- review_data %>%
group_by(verified) %>%
summarize(counts = n())
#print table
knitr::kable(verified_reviews)
library(tidyverse) #load libraries
review_data <- rio::import("data/review_data.csv") #load the data
#get number of reviews per year
review_by_year <- review_data %>%
group_by(year) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = review_by_year, mapping = aes(x=year, y=counts))+
geom_bar(stat = "identity", fill = "white", color = "black")+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Number of reviews per year", subtitle = "1999 to 2018")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))
#| tbl-subcap: Table 1. Number of reviews by purchase status
#get number of verified users
verified_reviews <- review_data %>%
group_by(verified) %>%
summarize(counts = n())
#print table
knitr::kable(verified_reviews)
#get number of reviews per year
year_by_verified_counts <- review_data %>%
group_by(year,verified) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = year_by_verified_counts,
mapping = aes(x=year, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity", color = "black")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Number of Reviews per year", subtitle = "By purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"), legend.position = "bottom", legend.background = element_rect(fill = "lightgrey"))
#get number of reviews per rating
review_by_rating <- review_data %>%
group_by(rating) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = review_by_rating, mapping = aes(x=rating, y=counts))+
geom_bar(stat = "identity", fill = "white", color = "black")+
xlab("")+ylab("")+
ggtitle(label = "Review ratings", subtitle = "Number of Reviews for each rating")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"))
#get number of reviews per rating
review_by_verified_counts <- review_data %>%
group_by(verified, rating) %>%
summarize(counts = n())
#plot, aes sets up mapping X.Y,
ggplot(data = review_by_verified_counts, mapping = aes(x = rating, y=counts, group = verified, fill = verified))+
geom_bar(stat = "identity", position = "dodge", color = "black")+
scale_fill_manual(values = c('#1b9e77','#d95f02'))+
xlab("")+ylab("")+
ggtitle(label = "Review ratings", subtitle = "Number of Reviews for each rating")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"), legend.position = "bottom", legend.background = element_rect(fill = "lightgrey"))
#| label: tbl-verified descriptives
#| tbl-cap: Average ratings by purchase status
#get mean and median ratings by verified users
verified_descriptives <- review_data %>%
group_by(verified) %>%
summarize(`Mean rating` = round(mean(rating), digits = 2),
`Median rating` = median(rating))
#print table
knitr::kable(verified_descriptives)
year_rating_status <- review_data %>%
group_by(year, verified) %>%
summarise(mean_rating = mean(rating), .groups = 'drop')
ggplot(data = year_rating_status,
mapping = aes(x=year, y=mean_rating, color = verified))+
geom_point(aes())+
geom_line()+
scale_color_manual(values = c('#1b9e77','#d95f02'))+
scale_x_continuous(breaks = 1999:2018)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))+
xlab("")+ylab("")+
ggtitle(label = "Average Ratings", subtitle = "By year and purchase status")+
theme(panel.grid.major=element_line(color = "darkgrey"), panel.grid.minor=element_line(color = "lightgrey"), panel.background = element_rect(fill = "lightgrey"), plot.background = element_rect(fill = "lightgrey"), legend.position = "bottom", legend.background = element_rect(fill = "lightgrey"))

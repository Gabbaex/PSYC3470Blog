---
title: "Final Project"
author: "Gabi Yepez"
date: "2023-05-17"
categories: [Final Project]
image: "cypher hd wallpaper.png"
---

# Final Project: T-test [Lab10] (one-sample, paired sample)

## Research Question:

The lab study uses open data from Experiment 1 of Mehr, Song, and Spelke (2016). This is a reproduction of the results found in their paper. The experiment asks 'Does music convey social information to infants?'. Different infants may grow up in different cultures and thus, the songs they are exposed to will differ. Following this pattern, when someone new sings a familiar song to an infant, it may signal that this person is part of their social group (Mehr et al., 2016).

## Data-Sources

<https://journals.sagepub.com/stoken/default+domain/d5HcBHg85XamSXGdYqYN/full>

<https://raw.githubusercontent.com/CrumpLab/statisticsLab/master/data/MehrSongSpelke2016.csv>

### Loading the data

```{r}
library(data.table) #loads data table library

all_data <- fread("https://raw.githubusercontent.com/CrumpLab/statisticsLab/master/data/MehrSongSpelke2016.csv") #loaded data via web address, easier than downloading data file
```

```{r}
library(summarytools) #use to summarize all data
view(dfSummary(all_data)) #will show summary of all data
```

```{r}
library(dplyr)
experiment_one <- all_data %>% filter(exp1==1) #filtering data to reduce rows into a new variable
```

### One Sample T-test [Baseline]

```{r}
#data from trials to show infant looking behavior didn't change due to chance
baseline <- experiment_one$Baseline_Proportion_Gaze_to_Singer
```

```{r}
#looking at numbers, shows all data point for each infant as dot
plot(baseline)

```


```{r}
#hist to show frequency proportions better
hist(baseline)
```

### Descriptives

```{r}
#mean and standard deviation for sample
mean(baseline)
sd(baseline)
```

### T-test

```{r}
t.test(baseline, mu=.5) #reported as "t(31) = .67, p = .505."
```

### Test Phase

```{r}
test_phase <- experiment_one$Test_Proportion_Gaze_to_Singer

plot(test_phase)
```

```{r}
hist(test_phase)
```

```{r}
mean(test_phase)
## [1] 0.5934913

sd(test_phase)
## [1] 0.1786884

t.test(test_phase, mu = .5)
```

### Paired-samples T-test

```{r}
t.test(test_phase, baseline, paired=TRUE, var.equal=TRUE)
```

```{r}
t.test(test_phase, baseline, paired=TRUE, var.equal=TRUE)

difference_scores<-test_phase-baseline

t.test(difference_scores, mu=0)
```

### Other source

```{r}
difference_scores <- test_phase-baseline

length(difference_scores[difference_scores>0])
```

### Graphing Findings

```{r}
#creating dataframe for plotting
Phase <- rep(c("Baseline","Test"), each = 32)

Proportions <- c(baseline,test_phase)

plot_df <- data.frame(Phase,Proportions)

plot_df
```


### Plot of Raw Scores

```{r}
library(ggplot2)

ggplot(plot_df, aes(x=Phase, y=Proportions))+
  geom_point()
```

### Plot of Raw Scores + Means

```{r}

mean_df <- aggregate(Proportions ~ Phase, plot_df, mean)


ggplot(plot_df, aes(x=Phase, y=Proportions))+ 
  geom_point()+
  geom_point(data=mean_df, color="Red", size=2)
```

### Bar Plot

```{r}

ggplot(plot_df, aes(x=Phase, y=Proportions))+ 
  geom_point()+
  geom_bar(data=mean_df, stat="identity",aes(fill=Phase))

```

```{r}

ggplot(plot_df, aes(x=Phase, y=Proportions))+ 
  geom_bar(data=mean_df, stat="identity",aes(fill=Phase))+
  geom_point()


```

### Bar Plot + Error bars

```{r}

difference_scores <- baseline-test_phase #calculate difference scores

standard_error <- sd(difference_scores)/sqrt(length(difference_scores)) #calculate SEM


ggplot(plot_df, aes(x=Phase, y=Proportions))+ 
  geom_bar(data=mean_df, stat="identity",aes(fill=Phase))+
  geom_errorbar(data=mean_df, aes(ymin=Proportions-standard_error, 
                                  ymax=Proportions+standard_error), width=.1) +
  geom_point(alpha=.25)

```

```{r}

difference_scores <- test_phase-baseline #calculate difference scores

standard_error <- sd(difference_scores)/sqrt(length(difference_scores)) #calculate SEM

mean_difference <- mean(difference_scores)

qplot(x="MeanDifference", y=mean_difference)+
  geom_bar(stat="identity", width=.5, alpha=.5)+
  geom_hline(yintercept=0)+
  geom_point(aes(y=difference_scores), alpha=.25)+
  geom_errorbar(aes(ymin=mean_difference-standard_error, 
                                  ymax=mean_difference+standard_error), width=.1)

```

### Bar Plot + Confidence Intervals

```{r}

t_test_results <- t.test(difference_scores)

lower_interval<- t_test_results$conf.int[1]

upper_interval<- t_test_results$conf.int[2]


qplot(x="MeanDifference", y=mean_difference)+
  geom_bar(stat="identity", width=.5, alpha=.5)+
  geom_hline(yintercept=0)+
  geom_point(aes(y=difference_scores), alpha=.25)+
  geom_errorbar(aes(ymin=lower_interval, 
                                  ymax=upper_interval), width=.1)

```

### Data Simulation

```{r}
sample_sd   <- (sd(baseline)+sd(test_phase))/2

simulated_means <- length(1000)
for(i in 1:1000){
 simulated_means[i] <- mean(rnorm(32,.5, sample_sd))
}

hist(simulated_means)
```

```{r}
#simulation of mean difference

sample_sd   <- sd(baseline-test_phase)

simulated_mean_difference <- length(1000)
for(i in 1:1000){
 simulated_mean_difference[i] <- mean(rnorm(32,0, sample_sd))
}

hist(simulated_mean_difference)

```

## References

Mehr, S. A., Song. L. A., & Spelke, E. S. (2016). For 5-month-old infants, melodies are social. Psychological Science, 27, 486-501.

Crump, M. J.C., Krishnan, A., Volz, S., Chavarga, A. (2018). Answering questions with data: Lab Manual.

<https://crumplab.com/statisticsLab/lab-6-t-test-one-sample-paired-sample.html#excel-6>

<https://journals.sagepub.com/stoken/default+domain/d5HcBHg85XamSXGdYqYN/full>